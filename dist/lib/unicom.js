"use strict";function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var f,a=t[Symbol.iterator]();!(n=(f=a.next()).done)&&(r.push(f.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueUnicom=e()}(window,function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("[object array]"==c.call(e).toLowerCase())for(var o=0;o<e.length;o+=1)t(e[o],r,n,i);else if(e){var f=n?n(e):e;void 0===f&&(f=e),i[f]||(r.push(f),i[f]=!0)}return r}function e(e,r,n){var i=s.get(this)||{},o=i.group||[];n&&t(n).forEach(function(t){if(o.indexOf(t)<0){var r=p[t];r&&r.splice(r.indexOf(e),1)}}),t(r).forEach(function(t){var r=p[t];r||(r=p[t]=[]),r.indexOf(e)<0&&r.push(e)})}function r(t,e,r){e!=r&&(r&&v[r]==t&&delete v[r],e&&(v[e]=t))}function n(e,r){return function(n,i){if("#"==i){if(r[y]!=n)return}else if("@"==i){var o=s.get(r).group,f=r[h],a=f?t(f):[];if((!o||o.indexOf(n)<0)&&a.indexOf(n)<0)return}for(var u=arguments.length,c=Array(u>2?u-2:0),l=2;l<u;l++)c[l-2]=arguments[l];e.apply(r,c)}}function i(t,e,r,n,i){if(t)return n.unshift(t,e,r,i),l.emit.apply(l,n)}function o(t){for(var e="",r="",n=!1,o=t.replace(/^([`~])/,function(t,e){return"~"==e&&(n=!0),""}).replace(/([@#])([^@#]*)$/,function(t,n,i){return e=i,r=n,""}),f=arguments.length,a=Array(f>1?f-1:0),u=1;u<f;u++)a[u-1]=arguments[u];if(n)return d.push([o,e,r,a,this]),this;var c=i(o,e,r,a,this);switch(r){case"#":return v[e]||null;case"@":return p[e]||[]}return c}function f(a){var u,c,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},g=v.name,m=void 0===g?"unicom":g,_=v.idName,b=v.groupName;if(!f.installed){f.installed=!0,a.prototype["$"+m]=o,y=_||m+"Id",h=b||m+"Name",a.mixin({props:(u={},_defineProperty(u,y,{type:String,default:""}),_defineProperty(u,h,{type:[String,Array],default:""}),u),watch:(c={},_defineProperty(c,y,function(t,e){r(this,t,e)}),_defineProperty(c,h,{deep:!0,handler:function(t,r){e(this,t,r)}}),c),beforeCreate:function(){var e=this,r=this.$options,i=r[m],o={},f=!1,a=o.uni={};i&&i.length&&(f=!0,i.forEach(function(t){if(t)for(var r in t){a[r]||(a[r]=[]);var i=n(t[r],e);a[r].push(i),l.on(r,i)}}));var u=o.group=[];t(r[h],u,function(t){var r=String(t);p[r]||(p[r]=[]),p[r].push(e)}),u.length>0&&(f=!0),f&&s.set(this,o)},created:function(){var t=this[y];t&&r(this,t);var n=this[h];n&&e(this,n);for(var o=s.get(this)||{},f=0;f<d.length;f+=1){var a=d[f],u=_slicedToArray(a,4),c=u[0],l=u[1],p=u[2],v=u[3],g=!1;"#"==p?l==t&&(g=!0):"@"==p?o.group&&o.group.indexOf(l)>-1&&(g=!0):(""==c||Object.keys(o.uni||{}).indexOf(c)>-1)&&(g=!0),g&&(""==c?v[0](this):(d.splice(f,1),f-=1,i.apply(this,a)))}},destroyed:function(){var t=this,n=this.unicomId;n&&r(this,void 0,n);var i=this[h];i&&e(this,void 0,i);var o=s.get(this);if(o){s.delete(this);var f=o.uni;for(var a in f)!function(t){f[t].forEach(function(e){l.off(t,e)})}(a);o.group.forEach(function(e){var r=p[e];if(r){var n=r.indexOf(t);n>-1&&r.splice(n,1),0==r.length&&delete p[e]}});for(var u=0;u<d.length;){var c=d[u];""==c[0]&&c[4]==this?d.splice(u,1):u+=1}}}});var w=a.config.optionMergeStrategies;w[m]=w[h]=function(t,e){var r=t||[];return e&&r.push(e),r}}}function a(){return o.apply(this,arguments)}var u=(Array.prototype.slice,function(){function t(){_classCallCheck(this,t);var e={},r=this._monitor_;if(r)for(var n in r){e[n]=[];for(var i=0;i<r[n].length;i+=1)e[n].push(r[n][i])}this._monitor_=e}return _createClass(t,[{key:"on",value:function(t,e){var r=this._monitor_||(this._monitor_={});return r[t]||(r[t]=[]),r[t].push(e),this}},{key:"off",value:function(t,e){var r=this._monitor_;if(r)if(e){var n=r[t];if(n){var i=n.indexOf(e);i>-1&&n.splice(i,1)}}else t?delete r[t]:delete this._monitor_;return this}},{key:"emit",value:function(t){var e=this._monitor_&&this._monitor_[t]||[];if(e.length){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var o=0;o<e.length;o+=1)e[o].apply(this,n)}return e.length>0}}]),t}()),c=Object.prototype.toString,l=new u,s=new Map,h="",p={},v={},y="",d=[];return a.EventEmitter=u,a.install=f,a});